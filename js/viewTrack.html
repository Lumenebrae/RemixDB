<!DOCTYPE html>
<html lang="en-US">
  <head>
    <link rel="stylesheet" href="purdue_css.css">
  </head>


  <body>
    <div>

      Track ID (TEMP):&nbsp;
      <input
        id="field_tid"
        className="long"
        type="text"
      />

      <button onclick="getTrack()">retrieve</button>
    </div>

<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->

    <div class = 'div_page_header'>
      <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/35/Purdue_Boilermakers_logo.svg/1200px-Purdue_Boilermakers_logo.svg.png" width="60" height="50"> View Track
    </div>

    <div id = 'track' class = 'div_header'>
      Track:
      <div id = 'track_internal'  class = 'div_internal'>
        <div id = 'track_title'>Title: </div>
        <div id = 'track_length'>Length: </div>
        <div id = 'trac_genre'>Genre: </div>
      </div>
    </div>
    <br>

    <div id = 'artist' class = 'div_header'>
      Artist:
      <div id = 'artist_internal'  class = 'div_internal'>
        <div id = 'artist_name'>Name: </div>
      </div>
    </div>
    <br>

    <div id = 'group' class = 'div_header'>
      Group:
      <div id = 'group_internal'  class = 'div_internal'>
        <div id = 'group_title'>Title: </div>
        <div id = 'group_year'>Year Formed: </div>
        <div id = 'group_type'>Type: </div>
      </div>
    </div>
    <br>

    <div id = 'album' class = 'div_header'>
      Album:
      <div id = 'track_internal'  class = 'div_internal'>
        <div id = 'album_name'>Name: </div>
      </div>
    </div>
    <br>

    <div id = 'remixes' class = 'div_header'>
      Remixes:
      <div id = 'remixes_internal'  class = 'div_internal_ol'>
        <ol>
          <li>Coffee</li>
          <li>Tea</li>
          <li>Milk</li>
        </ol>
      </div>
    </div>
    <br>

    <div id = 'source'  class = 'div_header'>
      Source Track:
      <div id = 'source_internal'  class = 'div_internal'>
        <div id = 'source_name'>Source Name: </div>
      </div>
    </div>

  </body>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script>
    function getTrack() {
      //null safety later
      var tid = document.getElementById("field_tid").value;
      var url = "http://localhost:8000/getTrack2.php?q=" + tid;
      var display = document.createElement('div');
      var displaytrack = document.getElementById('track');
      var displayartists = document.getElementById('artist');
      var displaygroups = document.getElementById('group');
      var displayremixes = document.getElementById('remixes');
      var displayremixof = document.getElementById('source');

      downloadUrl(url, function(data) {
      console.log(data);
      var xml = data.responseXML;
      var track = xml.documentElement.getElementsByTagName('track');
      console.log(xml);
      title = track[0].getAttribute('title');
      length = track[0].getAttribute('length');
      genre = track[0].getAttribute('genre');
      user = track[0].getAttribute('UID');
      displaytrack.appendChild(document.createTextNode(title + ', ' + length + ', ' + genre));
      display.appendChild(displaytrack)

      //artist and group info
      var artists = xml.documentElement.getElementsByTagName('artist');
      if (artists != null){
        for (x of artists) {
          aid = x.getAttribute('AID');
          names = x.getAttribute('name');
          displayartists.appendChild(document.createTextNode(' artist:' + aid + ', ' + names));
        }
        display.appendChild(displayartists)
      }
      var groups = xml.documentElement.getElementsByTagName('group');
      if (groups != null){
        for (x of groups) {
          aid = x.getAttribute('GID');
          names = x.getAttribute('name');
          displaygroups.appendChild(document.createTextNode('group:' + aid + ', ' + names));
        }
        display.appendChild(displaygroups)
      }

      //remix info
      var remixes = xml.documentElement.getElementsByTagName('remix');
      if (remixes != null){
        for (x of remixes) {
          tid = x.getAttribute('TID');
          title = x.getAttribute('title');
          displayremixes.appendChild(document.createTextNode('remix:' + tid + ', ' + title));
        }
        display.appendChild(displayremixes)
      }
      var sources = xml.documentElement.getElementsByTagName('source');
      if (sources != null){
        for (x of sources) {
          tid = x.getAttribute('TID');
          title = x.getAttribute('title');
          displayremixof.appendChild(document.createTextNode('source:' + tid + ', ' + title));
        }
        display.appendChild(displayremixof)
      }

      document.body.appendChild(display);
      });
    }

    function downloadUrl(url, callback) {
        var request = window.ActiveXObject ?
            new ActiveXObject('Microsoft.XMLHTTP') :
            new XMLHttpRequest;

            request.onreadystatechange = function() {
              if (request.readyState == 4) {
                request.onreadystatechange = doNothing;
                callback(request, request.status);
              }
            };

        request.open('GET', url, true);
        request.send(null);
        return 0;
    }

    function doNothing() {}


  </script>
</html>
